% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_catalogues.R
\name{sig_simulate_perfect}
\alias{sig_simulate_perfect}
\title{Simulate a Perfect (Noiseless) Catalogue from a Signature Model}
\usage{
sig_simulate_perfect(signatures, model, n, format = c("sigverse", "matrix"))
}
\arguments{
\item{signatures}{A named list of signatures in sigverse format. See \code{\link[sigshared:signature_collection]{sigshared::example_signature_collection()}}.}

\item{model}{A named numeric vector representing the proportion of each signature to include in the combined profile.
The names must match entries in \code{signatures}. See \code{\link[sigshared:model]{sigshared::example_model()}}}

\item{n}{The total number of mutations to simulate.}

\item{format}{The output format. Choose between:
\itemize{
\item \code{"sigverse"}: Returns a single sigverse-style catalogue data.frame with \code{channel}, \code{type}, \code{count}, and \code{fraction}.
\item \code{"matrix"}: Returns a matrix with \code{channel} names as rows and counts as values.
}}
}
\value{
A single perfect catalogue representing the deterministic combination of signatures in \code{model}.
Returned in either sigverse-style format or matrix form, depending on \code{format} argument.
}
\description{
This function creates a single synthetic mutation catalogue by \strong{deterministically} combining
multiple mutational signatures in fixed proportions (as specified by a model), then scaling
the resulting signature to exactly \code{n} mutations.
No randomness is introducedâ€”this is a "perfect" profile.
}
\details{
This is useful for generating ground truth references or benchmarking results without the noise introduced
by multinomial sampling (e.g. as used in \code{sig_simulate_mixed()}).
}
\examples{
library(sigstash)
signatures <- sig_load("COSMIC_v3.4_SBS_GRCh38")
model <- c(SBS1 = 0.7, SBS5 = 0.3)

perfect <- sig_simulate_perfect(signatures, model = model, n = 400)
head(perfect)

# Return as matrix
perfect_mat <- sig_simulate_perfect(signatures, model = model, n = 400, format = "matrix")

}
\seealso{
\code{\link[=sig_simulate_mixed]{sig_simulate_mixed()}} for noisy simulation from mixed signatures,
\code{\link[=sig_simulate_stratified]{sig_simulate_stratified()}} for stratified sampling, and \code{\link[sigstats:sig_reconstruct]{sigstats::sig_reconstruct()}} for
noiseless single-signature catalogues.
}
