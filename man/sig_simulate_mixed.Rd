% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_catalogues.R
\name{sig_simulate_mixed}
\alias{sig_simulate_mixed}
\title{Simulate catalogues from multiple signatures}
\usage{
sig_simulate_mixed(
  signatures,
  model,
  n,
  n_catalogues,
  format = c("sigverse", "matrix"),
  prefix = "catalogue",
  seed = NULL,
  simplify = FALSE
)
}
\arguments{
\item{signatures}{A list of signatures to combine and simulate from.
Each signature should be sigverse signature format (\code{\link[sigshared:signature_collection]{sigshared::example_signature_collection()}}).}

\item{model}{A model for combining the signatures. This can represent the
proportions or contributions of each signature in the combined result.}

\item{n}{The number of mutations to sample in each catalogue.}

\item{n_catalogues}{The number of catalogues to generate (default is 1).}

\item{format}{The format to return the generated catalogues in. Choose between:
\itemize{
\item "sigverse": Return a sigverse-style catalogue collection. See \code{\link[sigshared:catalogue_collections]{sigshared::example_catalogue_collection()}}.
\item "matrix": Return a matrix where each column corresponds to a simulated catalogue,
with rownames as channels and values as mutation counts.
}}

\item{prefix}{A string prefix to use for naming each catalogue. Defaults to "catalogue".}

\item{seed}{random seed to use for generation.}

\item{simplify}{A logical value indicating whether to return a single catalogue
(as a tibble) when only one catalogue is generated and \code{format = "sigverse"}.
Defaults to FALSE.}
}
\description{
Simulates mutation catalogues by first combining multiple
signatures (according to specified proportions in the \code{model}), and then sampling mutations
from the resulting \emph{combined} signature using a multinomial distribution.
}
\details{
This approach introduces \strong{realistic sampling noise}, which mimics how mutations
arise in actual biological samples. It is ideal for benchmarking how well tools
can detect signatures when contributions are probabilistic rather than exact.

Unlike \code{\link[=sig_simulate_stratified]{sig_simulate_stratified()}}, this method does \strong{not} guarantee exact
counts per signature in the output â€” the breakdown is subject to sampling variation.
To simulate catalogues with \emph{deterministic} signature contributions (no noise),
use \code{\link[=sig_simulate_perfect]{sig_simulate_perfect()}}.
}
\examples{
library(sigstash)

# Load Signature Collection
signatures <- sig_load('COSMIC_v3.4_SBS_GRCh38')

# Define Model
model <- c(SBS1 = 0.6, SBS5 = 0.4)

# Simulate randomly from a mixed signature
sig_simulate_mixed(signatures, model, n = 400, n_catalogues=3)

}
\seealso{
\itemize{
\item \code{\link[=sig_simulate_perfect]{sig_simulate_perfect()}} for noiseless catalogue generation
\item \code{\link[=sig_simulate_stratified]{sig_simulate_stratified()}} for sampling each signature independently
\item \code{\link[=sig_simulate_single]{sig_simulate_single()}} for sampling from a single signature only
}
}
